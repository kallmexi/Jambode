<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SteamShare Pro - Hub Database Akun</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1b2838;
            color: #c7d5e0;
            overflow-x: hidden;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            inset: 0;
            background: #171a21;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.8s ease-out;
        }

        .loader-text {
            font-size: 2.5rem;
            font-weight: 900;
            color: #66c0f4;
            letter-spacing: 0.2rem;
            text-transform: uppercase;
            text-align: center;
            animation: pulse-text 1.5s infinite;
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.05); }
        }

        .steam-gradient {
            background: radial-gradient(at top left, #1b2838 0%, #171a21 100%);
        }

        .card-glass {
            background: rgba(42, 71, 94, 0.3);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(102, 192, 244, 0.1);
            transition: all 0.3s ease;
        }

        .card-glass:hover {
            transform: translateY(-5px);
            border-color: rgba(102, 192, 244, 0.4);
            box-shadow: 0 15px 30px rgba(0,0,0,0.5);
        }

        .ad-container {
            background: rgba(0,0,0,0.4);
            border: 1px dashed #4b5563;
            overflow: hidden;
            border-radius: 8px;
            position: relative;
        }

        #adminPanel {
            display: none;
            border: 2px dashed #f59e0b;
            background: rgba(245, 158, 11, 0.05);
            margin-bottom: 2rem;
        }
    </style>
</head>
<body class="steam-gradient min-h-screen">

    <!-- Screen Loading -->
    <div id="loading-screen">
        <div class="mb-4 text-center">
            <i class="fa-brands fa-steam text-7xl text-[#66c0f4] mb-4"></i>
            <div class="loader-text">DATABASE AKTIF</div>
            <div class="mt-2 text-gray-500 text-xs tracking-[0.3em] uppercase opacity-50">Menyiapkan Database Akun...</div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app-content" class="opacity-0 transition-opacity duration-1000">
        <!-- Navbar -->
        <nav class="sticky top-0 z-50 bg-[#171a21]/95 backdrop-blur-md border-b border-gray-800">
            <div class="container mx-auto px-6 py-4 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <i class="fa-brands fa-steam text-3xl text-[#66c0f4]"></i>
                    <span class="text-xl font-black text-white uppercase tracking-tighter">Steam<span class="text-[#66c0f4]">Share</span></span>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Tombol Gembok untuk Admin -->
                    <button id="adminBtn" class="text-gray-500 hover:text-[#f59e0b] transition p-2">
                        <i id="lock-icon" class="fa-solid fa-lock text-lg"></i>
                    </button>
                    <a href="https://t.me/FREE_STEAM_ACCOUNT_DISCUSSION" target="_blank" class="bg-[#0088cc] px-6 py-2 rounded-full text-white font-bold items-center gap-2 hover:brightness-110 transition shadow-lg flex">
                        <i class="fa-brands fa-telegram text-lg"></i> <span class="hidden sm:inline">Grup Diskusi</span>
                    </a>
                </div>
            </div>
        </nav>

        <!-- Iklan Atas -->
        <div class="container mx-auto px-6 pt-10">
            <div class="ad-container w-full h-24 mb-10 flex flex-col items-center justify-center">
                <span class="text-[10px] text-gray-600 mb-1 tracking-[0.3em]">IKLAN BANNER</span>
                <img src="https://via.placeholder.com/728x90/171a21/66c0f4?text=DAFTAR+ADSENSE+UNTUK+HASILKAN+UANG" alt="Iklan" class="max-w-full h-full object-contain">
            </div>

            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-black text-white mb-4 tracking-tighter">DATABASE AKUN STEAM</h1>
                <p class="text-gray-400 max-w-xl mx-auto italic font-light">"Berbagi Akun Game Original Gratis Untuk Semua"</p>
            </div>
        </div>

        <!-- Panel Admin -->
        <div id="adminPanel" class="container mx-auto px-6">
            <div class="p-6 rounded-2xl bg-[#f59e0b]/5 border border-[#f59e0b]/20 mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-orange-500 font-bold uppercase tracking-widest text-sm">
                        <i class="fa-solid fa-screwdriver-wrench mr-2"></i> Control Panel Admin
                    </h3>
                    <button id="closeAdminBtn" class="text-xs bg-red-500/20 px-3 py-1 rounded-full text-red-500 hover:bg-red-500 hover:text-white transition">Tutup</button>
                </div>
                <form id="accForm" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <input type="text" id="gameTitle" placeholder="Nama Game" class="bg-[#171a21] border border-gray-700 p-3 rounded-xl outline-none focus:border-[#66c0f4] text-sm text-white" required>
                    <input type="text" id="username" placeholder="Username Akun" class="bg-[#171a21] border border-gray-700 p-3 rounded-xl outline-none focus:border-[#66c0f4] text-sm text-white" required>
                    <input type="text" id="password" placeholder="Password Akun" class="bg-[#171a21] border border-gray-700 p-3 rounded-xl outline-none focus:border-[#66c0f4] text-sm text-white" required>
                    <button type="submit" class="bg-orange-500 hover:bg-orange-600 text-white font-black py-3 rounded-xl transition shadow-lg">POSTING AKUN</button>
                </form>
            </div>
        </div>

        <!-- Grid Akun -->
        <div class="container mx-auto px-6 grid grid-cols-1 lg:grid-cols-4 gap-8 mb-20">
            <div class="lg:col-span-3">
                <div id="accountsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6 min-h-[300px]">
                    <!-- Konten Akun -->
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                <div class="bg-gradient-to-br from-[#0088cc] to-[#005588] p-8 rounded-3xl text-white shadow-2xl relative overflow-hidden group">
                    <i class="fa-brands fa-telegram absolute -right-6 -bottom-6 text-9xl opacity-10 group-hover:scale-110 transition-transform"></i>
                    <h3 class="text-2xl font-black mb-2 uppercase italic">Telegram</h3>
                    <p class="text-xs text-blue-100 mb-6 relative z-10 font-medium">Gabung komunitas untuk update akun terbaru!</p>
                    <a href="https://t.me/FREE_STEAM_ACCOUNT_DISCUSSION" target="_blank" class="block bg-white text-[#0088cc] text-center font-black py-3 rounded-2xl hover:bg-blue-50 transition relative z-10 shadow-lg">JOIN SEKARANG</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifikasi Toast -->
    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-[#66c0f4] text-white px-8 py-4 rounded-2xl font-black shadow-2xl opacity-0 scale-90 z-[1000] pointer-events-none transition-all duration-300 uppercase tracking-widest text-xs text-center min-w-[200px]">
        Berhasil!
    </div>

    <!-- Firebase Scripting -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = {
          apiKey: "AIzaSyAf0q6V5c2Ii-GUz29to6k3PJ_ykTFDt2k",
          authDomain: "mantap-39d34.firebaseapp.com",
          projectId: "mantap-39d34",
          storageBucket: "mantap-39d34.firebasestorage.app",
          messagingSenderId: "574079637547",
          appId: "1:574079637547:web:22f39dd01ed067b74df26e",
          measurementId: "G-SD62258ZB1"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        const appId = "kall-main-hub"; 
        const ADMIN_PASSCODE = "1234"; 
        let isAdmin = false;

        // Inisialisasi Aplikasi
        async function startApp() {
            try {
                await signInAnonymously(auth);
            } catch (err) {
                console.error("Auth error:", err);
            }
        }

        onAuthStateChanged(auth, (user) => {
            if (user) {
                loadData();
                hideLoader();
            }
        });

        function hideLoader() {
            setTimeout(() => {
                document.getElementById('loading-screen').style.opacity = '0';
                document.getElementById('app-content').style.opacity = '1';
                setTimeout(() => document.getElementById('loading-screen').style.display = 'none', 800);
            }, 1000);
        }

        // Ambil Data
        function loadData() {
            const q = query(collection(db, 'artifacts', appId, 'public', 'data', 'accounts'));
            
            onSnapshot(q, (snapshot) => {
                const container = document.getElementById('accountsContainer');
                container.innerHTML = '';
                
                if (snapshot.empty) {
                    container.innerHTML = `
                        <div class="col-span-full py-20 text-center border-2 border-dashed border-gray-800 rounded-3xl opacity-30">
                            <p class="font-bold uppercase tracking-widest text-xs">Database Kosong</p>
                        </div>
                    `;
                    return;
                }

                snapshot.forEach((docSnap) => {
                    const data = docSnap.data();
                    const id = docSnap.id;
                    const card = document.createElement('div');
                    card.className = 'card-glass p-7 rounded-3xl relative overflow-hidden group border border-white/5';
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <div class="text-[10px] text-[#66c0f4] font-black uppercase tracking-[0.2em] mb-1 italic">Account Ready</div>
                                <h3 class="text-white font-black text-xl italic uppercase tracking-tighter">${data.game}</h3>
                            </div>
                            <div id="admin-actions-${id}" class="${isAdmin ? 'block' : 'hidden'}">
                                <button onclick="window.deleteAcc('${id}')" class="text-red-500 p-2 hover:bg-red-500/20 rounded-lg"><i class="fa-solid fa-trash"></i></button>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-black/40 p-3 rounded-2xl flex justify-between items-center border border-white/5">
                                <span class="text-[9px] text-gray-500 font-black tracking-widest uppercase">Username</span>
                                <div class="flex items-center gap-3">
                                    <code class="text-sm font-bold text-[#66c0f4]">${data.user}</code>
                                    <button onclick="window.copyToClipboard('${data.user}')" class="text-gray-500 hover:text-white"><i class="fa-regular fa-copy"></i></button>
                                </div>
                            </div>
                            <div class="bg-black/40 p-3 rounded-2xl flex justify-between items-center border border-white/5">
                                <span class="text-[9px] text-gray-500 font-black tracking-widest uppercase">Password</span>
                                <div class="flex items-center gap-3">
                                    <code class="text-sm font-bold text-[#66c0f4]">${data.pass}</code>
                                    <button onclick="window.copyToClipboard('${data.pass}')" class="text-gray-500 hover:text-white"><i class="fa-regular fa-copy"></i></button>
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }, (err) => {
                console.error("Firestore error:", err);
            });
        }

        // Logic Admin Terpusat (Diperbaiki agar window bisa akses)
        window.requestAdminAccess = () => {
            if (isAdmin) {
                window.toggleAdmin(false);
                return;
            }
            const pass = prompt("MASUKKAN PIN ADMIN:");
            if (pass === ADMIN_PASSCODE) {
                window.toggleAdmin(true);
            } else if (pass !== null) {
                alert("PIN SALAH JIER!");
            }
        };

        window.toggleAdmin = (val) => {
            isAdmin = val;
            document.getElementById('adminPanel').style.display = val ? 'block' : 'none';
            document.getElementById('lock-icon').className = val ? 'fa-solid fa-unlock text-orange-500' : 'fa-solid fa-lock';
            loadData(); // Refresh list agar tombol hapus muncul/hilang
        };

        // Event Listeners untuk tombol-tombol HTML
        document.getElementById('adminBtn').addEventListener('click', window.requestAdminAccess);
        document.getElementById('closeAdminBtn').addEventListener('click', () => window.toggleAdmin(false));

        // Form Submit
        document.getElementById('accForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const game = document.getElementById('gameTitle').value;
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;

            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'accounts'), {
                    game, user, pass, timestamp: Date.now()
                });
                e.target.reset();
                window.showToast("AKUN BERHASIL DI-POSTING!");
            } catch (err) {
                alert("Gagal: " + err.message);
            }
        });

        // Hapus & Copy Global
        window.deleteAcc = async (id) => {
            if(confirm('Hapus akun ini dari database?')) {
                try {
                    await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'accounts', id));
                    window.showToast("AKUN DIHAPUS");
                } catch (err) { alert("Gagal hapus!"); }
            }
        };

        window.copyToClipboard = (text) => {
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el); el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            window.showToast("DATA DISALIN!");
        };

        window.showToast = (msg) => {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.opacity = '1'; t.style.transform = 'translateX(-50%) scale(1)';
            setTimeout(() => {
                t.style.opacity = '0'; t.style.transform = 'translateX(-50%) scale(0.9)';
            }, 2000);
        }

        startApp();
    </script>
</body>
</html>
